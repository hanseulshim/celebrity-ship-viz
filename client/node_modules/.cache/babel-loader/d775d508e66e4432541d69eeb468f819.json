{"ast":null,"code":"import _objectSpread from\"/Users/hanseulshim/Projects/celebrity-ship-viz/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/Users/hanseulshim/Projects/celebrity-ship-viz/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/hanseulshim/Projects/celebrity-ship-viz/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectWithoutProperties from\"/Users/hanseulshim/Projects/celebrity-ship-viz/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _taggedTemplateLiteral from\"/Users/hanseulshim/Projects/celebrity-ship-viz/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  color: \",\";\\n  background-color: \",\";\\n  padding: 0.25em 0.25em;\\n  font-weight: 500;\\n  font-size: 0.75rem;\\n  border-radius: 2px;\\n  cursor: pointer;\\n  min-width: 50px;\\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.24), 0 0 2px 0 rgba(0, 0, 0, 0.12);\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  color: \",\";\\n  background-color: \",\";\\n  padding: 0.5em 1em;\\n  font-weight: 500;\\n  font-size: 1rem;\\n  border-radius: 2px;\\n  cursor: pointer;\\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.24), 0 0 2px 0 rgba(0, 0, 0, 0.12);\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useContext,useEffect}from'react';import styled from'styled-components';import{store}from'context/store';import{useLazyQuery}from'@apollo/client';import{GET_VISUAL_DECK_LIST}from'graphql/queries';import{getFilterVariables}from'helper';import{StyledMenu,StyledCheckbox,StyledDropdown}from'components/common/StyledComponents';var Button=styled.button(_templateObject(),function(props){return props.theme.jungleMist;},function(props){return props.theme.biscay;});var ApplyButton=styled.button(_templateObject2(),function(props){return props.theme.white;},function(props){return props.theme.biscay;});var DropdownMenu=function DropdownMenu(_ref){var options=_ref.options,title=_ref.title,displayKey=_ref.displayKey,props=_objectWithoutProperties(_ref,[\"options\",\"title\",\"displayKey\"]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),visible=_useState2[0],setVisible=_useState2[1];var globalState=useContext(store);var state=globalState.state,dispatch=globalState.dispatch;var selectedShip=state.selectedShip,selectedProduct=state.selectedProduct,selectedItinerary=state.selectedItinerary,selectedSailDate=state.selectedSailDate,selectedBookingWeek=state.selectedBookingWeek,peerGroupFilters=state.peerGroupFilters,selectedPeerShip=state.selectedPeerShip,selectedPeerProduct=state.selectedPeerProduct,selectedPeerSailingDates=state.selectedPeerSailingDates,filter=state.filter,peerFilter=state.peerFilter,filterCount=state.filterCount;var _useLazyQuery=useLazyQuery(GET_VISUAL_DECK_LIST,{onCompleted:function onCompleted(data){dispatch({type:'setShipData',value:data.deckVisualList});},fetchPolicy:'network-only'}),_useLazyQuery2=_slicedToArray(_useLazyQuery,1),applyFilters=_useLazyQuery2[0];// keep local state array for save button\nvar _useState3=useState(filter[title]),_useState4=_slicedToArray(_useState3,2),subFilter=_useState4[0],setSubFilter=_useState4[1];useEffect(function(){setSubFilter(filter[title]);},[filter,title]);var handleCheck=function handleCheck(_ref2){var id=_ref2.id,value=_ref2.value;var foundFilter=subFilter.find(function(v){return v.id===id;});if(foundFilter){setSubFilter(subFilter.filter(function(v){return v.id!==id;}));}else{setSubFilter([].concat(_toConsumableArray(subFilter),[{id:id,value:value}]));}};var handleSave=function handleSave(e){if(e.key==='save'){dispatch({type:'setSelectedSubFilter',title:title,value:subFilter});var filterCopy=_objectSpread({},filter);setVisible(false);filterCopy[title]=subFilter;applyFilters({variables:getFilterVariables(selectedShip.id,selectedSailDate.id,selectedBookingWeek,selectedProduct.id,selectedItinerary.id,peerGroupFilters,selectedPeerShip,selectedPeerProduct.id,selectedPeerSailingDates[0],selectedPeerSailingDates[1],filterCopy,peerFilter,filterCount)});}};var handleVisibleChange=function handleVisibleChange(v){setVisible(v);if(!v){setSubFilter(filter[title]);}};var formatTitle=function formatTitle(s){var split=s.replace(/([a-z](?=[A-Z]))/g,'$1 ');return split.charAt(0).toUpperCase()+split.slice(1);};var menu=React.createElement(StyledMenu,{onClick:handleSave},options.map(function(option,i){return React.createElement(StyledMenu.Item,{key:'option'+i},React.createElement(StyledCheckbox,{onChange:function onChange(){return handleCheck(option);},checked:!!subFilter.find(function(f){return f.id===option.id;})},option[displayKey]));}),React.createElement(StyledMenu.Item,{key:\"save\"},React.createElement(ApplyButton,null,\"Apply\")));return React.createElement(StyledDropdown,{overlay:menu,onVisibleChange:handleVisibleChange,visible:visible},React.createElement(Button,null,formatTitle(title)));};export default DropdownMenu;","map":{"version":3,"sources":["/Users/hanseulshim/Projects/celebrity-ship-viz/src/components/main/filters/sub-filters/DropdownMenu.js"],"names":["React","useState","useContext","useEffect","styled","store","useLazyQuery","GET_VISUAL_DECK_LIST","getFilterVariables","StyledMenu","StyledCheckbox","StyledDropdown","Button","button","props","theme","jungleMist","biscay","ApplyButton","white","DropdownMenu","options","title","displayKey","visible","setVisible","globalState","state","dispatch","selectedShip","selectedProduct","selectedItinerary","selectedSailDate","selectedBookingWeek","peerGroupFilters","selectedPeerShip","selectedPeerProduct","selectedPeerSailingDates","filter","peerFilter","filterCount","onCompleted","data","type","value","deckVisualList","fetchPolicy","applyFilters","subFilter","setSubFilter","handleCheck","id","foundFilter","find","v","handleSave","e","key","filterCopy","variables","handleVisibleChange","formatTitle","s","split","replace","charAt","toUpperCase","slice","menu","map","option","i","f"],"mappings":"kjDAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,UAA1B,CAAsCC,SAAtC,KAAuD,OAAvD,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OAASC,KAAT,KAAsB,eAAtB,CACA,OAASC,YAAT,KAA6B,gBAA7B,CAEA,OAASC,oBAAT,KAAqC,iBAArC,CACA,OAASC,kBAAT,KAAmC,QAAnC,CACA,OACEC,UADF,CAEEC,cAFF,CAGEC,cAHF,KAIO,oCAJP,CAMA,GAAMC,CAAAA,MAAM,CAAGR,MAAM,CAACS,MAAV,mBAID,SAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,KAAN,CAAYC,UAAhB,EAJJ,CAKU,SAAAF,KAAK,QAAIA,CAAAA,KAAK,CAACC,KAAN,CAAYE,MAAhB,EALf,CAAZ,CAcA,GAAMC,CAAAA,WAAW,CAAGd,MAAM,CAACS,MAAV,oBAIN,SAAAC,KAAK,QAAIA,CAAAA,KAAK,CAACC,KAAN,CAAYI,KAAhB,EAJC,CAKK,SAAAL,KAAK,QAAIA,CAAAA,KAAK,CAACC,KAAN,CAAYE,MAAhB,EALV,CAAjB,CAeA,GAAMG,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAA8C,IAA3CC,CAAAA,OAA2C,MAA3CA,OAA2C,CAAlCC,KAAkC,MAAlCA,KAAkC,CAA3BC,UAA2B,MAA3BA,UAA2B,CAAZT,KAAY,+EACnCb,QAAQ,CAAC,KAAD,CAD2B,wCAC1DuB,OAD0D,eACjDC,UADiD,eAEjE,GAAMC,CAAAA,WAAW,CAAGxB,UAAU,CAACG,KAAD,CAA9B,CAFiE,GAGzDsB,CAAAA,KAHyD,CAGrCD,WAHqC,CAGzDC,KAHyD,CAGlDC,QAHkD,CAGrCF,WAHqC,CAGlDE,QAHkD,IAK/DC,CAAAA,YAL+D,CAiB7DF,KAjB6D,CAK/DE,YAL+D,CAM/DC,eAN+D,CAiB7DH,KAjB6D,CAM/DG,eAN+D,CAO/DC,iBAP+D,CAiB7DJ,KAjB6D,CAO/DI,iBAP+D,CAQ/DC,gBAR+D,CAiB7DL,KAjB6D,CAQ/DK,gBAR+D,CAS/DC,mBAT+D,CAiB7DN,KAjB6D,CAS/DM,mBAT+D,CAU/DC,gBAV+D,CAiB7DP,KAjB6D,CAU/DO,gBAV+D,CAW/DC,gBAX+D,CAiB7DR,KAjB6D,CAW/DQ,gBAX+D,CAY/DC,mBAZ+D,CAiB7DT,KAjB6D,CAY/DS,mBAZ+D,CAa/DC,wBAb+D,CAiB7DV,KAjB6D,CAa/DU,wBAb+D,CAc/DC,MAd+D,CAiB7DX,KAjB6D,CAc/DW,MAd+D,CAe/DC,UAf+D,CAiB7DZ,KAjB6D,CAe/DY,UAf+D,CAgB/DC,WAhB+D,CAiB7Db,KAjB6D,CAgB/Da,WAhB+D,mBAkB1ClC,YAAY,CAACC,oBAAD,CAAuB,CACxDkC,WAAW,CAAE,qBAAAC,IAAI,CAAI,CACnBd,QAAQ,CAAC,CAAEe,IAAI,CAAE,aAAR,CAAuBC,KAAK,CAAEF,IAAI,CAACG,cAAnC,CAAD,CAAR,CACD,CAHuD,CAIxDC,WAAW,CAAE,cAJ2C,CAAvB,CAlB8B,gDAkB1DC,YAlB0D,mBAyBjE;AAzBiE,eA0B/B9C,QAAQ,CAACqC,MAAM,CAAChB,KAAD,CAAP,CA1BuB,yCA0B1D0B,SA1B0D,eA0B/CC,YA1B+C,eA4BjE9C,SAAS,CAAC,UAAM,CACd8C,YAAY,CAACX,MAAM,CAAChB,KAAD,CAAP,CAAZ,CACD,CAFQ,CAEN,CAACgB,MAAD,CAAShB,KAAT,CAFM,CAAT,CAIA,GAAM4B,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,OAAmB,IAAhBC,CAAAA,EAAgB,OAAhBA,EAAgB,CAAZP,KAAY,OAAZA,KAAY,CACrC,GAAMQ,CAAAA,WAAW,CAAGJ,SAAS,CAACK,IAAV,CAAe,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACH,EAAF,GAASA,EAAb,EAAhB,CAApB,CACA,GAAIC,WAAJ,CAAiB,CACfH,YAAY,CAACD,SAAS,CAACV,MAAV,CAAiB,SAAAgB,CAAC,QAAIA,CAAAA,CAAC,CAACH,EAAF,GAASA,EAAb,EAAlB,CAAD,CAAZ,CACD,CAFD,IAEO,CACLF,YAAY,8BAAKD,SAAL,GAAgB,CAAEG,EAAE,CAAFA,EAAF,CAAMP,KAAK,CAALA,KAAN,CAAhB,GAAZ,CACD,CACF,CAPD,CASA,GAAMW,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAAAC,CAAC,CAAI,CACtB,GAAIA,CAAC,CAACC,GAAF,GAAU,MAAd,CAAsB,CACpB7B,QAAQ,CAAC,CAAEe,IAAI,CAAE,sBAAR,CAAgCrB,KAAK,CAALA,KAAhC,CAAuCsB,KAAK,CAAEI,SAA9C,CAAD,CAAR,CACA,GAAMU,CAAAA,UAAU,kBAAQpB,MAAR,CAAhB,CACAb,UAAU,CAAC,KAAD,CAAV,CACAiC,UAAU,CAACpC,KAAD,CAAV,CAAoB0B,SAApB,CACAD,YAAY,CAAC,CACXY,SAAS,CAAEnD,kBAAkB,CAC3BqB,YAAY,CAACsB,EADc,CAE3BnB,gBAAgB,CAACmB,EAFU,CAG3BlB,mBAH2B,CAI3BH,eAAe,CAACqB,EAJW,CAK3BpB,iBAAiB,CAACoB,EALS,CAM3BjB,gBAN2B,CAO3BC,gBAP2B,CAQ3BC,mBAAmB,CAACe,EARO,CAS3Bd,wBAAwB,CAAC,CAAD,CATG,CAU3BA,wBAAwB,CAAC,CAAD,CAVG,CAW3BqB,UAX2B,CAY3BnB,UAZ2B,CAa3BC,WAb2B,CADlB,CAAD,CAAZ,CAiBD,CACF,CAxBD,CA0BA,GAAMoB,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,CAAAN,CAAC,CAAI,CAC/B7B,UAAU,CAAC6B,CAAD,CAAV,CACA,GAAI,CAACA,CAAL,CAAQ,CACNL,YAAY,CAACX,MAAM,CAAChB,KAAD,CAAP,CAAZ,CACD,CACF,CALD,CAOA,GAAMuC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAAAC,CAAC,CAAI,CACvB,GAAMC,CAAAA,KAAK,CAAGD,CAAC,CAACE,OAAF,CAAU,mBAAV,CAA+B,KAA/B,CAAd,CACA,MAAOD,CAAAA,KAAK,CAACE,MAAN,CAAa,CAAb,EAAgBC,WAAhB,GAAgCH,KAAK,CAACI,KAAN,CAAY,CAAZ,CAAvC,CACD,CAHD,CAKA,GAAMC,CAAAA,IAAI,CACR,oBAAC,UAAD,EAAY,OAAO,CAAEb,UAArB,EACGlC,OAAO,CAACgD,GAAR,CAAY,SAACC,MAAD,CAASC,CAAT,QACX,qBAAC,UAAD,CAAY,IAAZ,EAAiB,GAAG,CAAE,SAAWA,CAAjC,EACE,oBAAC,cAAD,EACE,QAAQ,CAAE,0BAAMrB,CAAAA,WAAW,CAACoB,MAAD,CAAjB,EADZ,CAEE,OAAO,CAAE,CAAC,CAACtB,SAAS,CAACK,IAAV,CAAe,SAAAmB,CAAC,QAAIA,CAAAA,CAAC,CAACrB,EAAF,GAASmB,MAAM,CAACnB,EAApB,EAAhB,CAFb,EAIGmB,MAAM,CAAC/C,UAAD,CAJT,CADF,CADW,EAAZ,CADH,CAWE,oBAAC,UAAD,CAAY,IAAZ,EAAiB,GAAG,CAAC,MAArB,EACE,oBAAC,WAAD,cADF,CAXF,CADF,CAkBA,MACE,qBAAC,cAAD,EACE,OAAO,CAAE6C,IADX,CAEE,eAAe,CAAER,mBAFnB,CAGE,OAAO,CAAEpC,OAHX,EAKE,oBAAC,MAAD,MAASqC,WAAW,CAACvC,KAAD,CAApB,CALF,CADF,CASD,CA1GD,CA4GA,cAAeF,CAAAA,YAAf","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\nimport styled from 'styled-components'\nimport { store } from 'context/store'\nimport { useLazyQuery } from '@apollo/client'\n\nimport { GET_VISUAL_DECK_LIST } from 'graphql/queries'\nimport { getFilterVariables } from 'helper'\nimport {\n  StyledMenu,\n  StyledCheckbox,\n  StyledDropdown\n} from 'components/common/StyledComponents'\n\nconst Button = styled.button`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: ${props => props.theme.jungleMist};\n  background-color: ${props => props.theme.biscay};\n  padding: 0.5em 1em;\n  font-weight: 500;\n  font-size: 1rem;\n  border-radius: 2px;\n  cursor: pointer;\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.24), 0 0 2px 0 rgba(0, 0, 0, 0.12);\n`\n\nconst ApplyButton = styled.button`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: ${props => props.theme.white};\n  background-color: ${props => props.theme.biscay};\n  padding: 0.25em 0.25em;\n  font-weight: 500;\n  font-size: 0.75rem;\n  border-radius: 2px;\n  cursor: pointer;\n  min-width: 50px;\n  box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.24), 0 0 2px 0 rgba(0, 0, 0, 0.12);\n`\n\nconst DropdownMenu = ({ options, title, displayKey, ...props }) => {\n  const [visible, setVisible] = useState(false)\n  const globalState = useContext(store)\n  const { state, dispatch } = globalState\n  const {\n    selectedShip,\n    selectedProduct,\n    selectedItinerary,\n    selectedSailDate,\n    selectedBookingWeek,\n    peerGroupFilters,\n    selectedPeerShip,\n    selectedPeerProduct,\n    selectedPeerSailingDates,\n    filter,\n    peerFilter,\n    filterCount\n  } = state\n  const [applyFilters] = useLazyQuery(GET_VISUAL_DECK_LIST, {\n    onCompleted: data => {\n      dispatch({ type: 'setShipData', value: data.deckVisualList })\n    },\n    fetchPolicy: 'network-only'\n  })\n\n  // keep local state array for save button\n  const [subFilter, setSubFilter] = useState(filter[title])\n\n  useEffect(() => {\n    setSubFilter(filter[title])\n  }, [filter, title])\n\n  const handleCheck = ({ id, value }) => {\n    const foundFilter = subFilter.find(v => v.id === id)\n    if (foundFilter) {\n      setSubFilter(subFilter.filter(v => v.id !== id))\n    } else {\n      setSubFilter([...subFilter, { id, value }])\n    }\n  }\n\n  const handleSave = e => {\n    if (e.key === 'save') {\n      dispatch({ type: 'setSelectedSubFilter', title, value: subFilter })\n      const filterCopy = { ...filter }\n      setVisible(false)\n      filterCopy[title] = subFilter\n      applyFilters({\n        variables: getFilterVariables(\n          selectedShip.id,\n          selectedSailDate.id,\n          selectedBookingWeek,\n          selectedProduct.id,\n          selectedItinerary.id,\n          peerGroupFilters,\n          selectedPeerShip,\n          selectedPeerProduct.id,\n          selectedPeerSailingDates[0],\n          selectedPeerSailingDates[1],\n          filterCopy,\n          peerFilter,\n          filterCount\n        )\n      })\n    }\n  }\n\n  const handleVisibleChange = v => {\n    setVisible(v)\n    if (!v) {\n      setSubFilter(filter[title])\n    }\n  }\n\n  const formatTitle = s => {\n    const split = s.replace(/([a-z](?=[A-Z]))/g, '$1 ')\n    return split.charAt(0).toUpperCase() + split.slice(1)\n  }\n\n  const menu = (\n    <StyledMenu onClick={handleSave}>\n      {options.map((option, i) => (\n        <StyledMenu.Item key={'option' + i}>\n          <StyledCheckbox\n            onChange={() => handleCheck(option)}\n            checked={!!subFilter.find(f => f.id === option.id)}\n          >\n            {option[displayKey]}\n          </StyledCheckbox>\n        </StyledMenu.Item>\n      ))}\n      <StyledMenu.Item key=\"save\">\n        <ApplyButton>Apply</ApplyButton>\n      </StyledMenu.Item>\n    </StyledMenu>\n  )\n\n  return (\n    <StyledDropdown\n      overlay={menu}\n      onVisibleChange={handleVisibleChange}\n      visible={visible}\n    >\n      <Button>{formatTitle(title)}</Button>\n    </StyledDropdown>\n  )\n}\n\nexport default DropdownMenu\n"]},"metadata":{},"sourceType":"module"}