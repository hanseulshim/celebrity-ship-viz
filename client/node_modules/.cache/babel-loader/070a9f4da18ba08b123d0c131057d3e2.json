{"ast":null,"code":"import _slicedToArray from \"/Users/hanseulshim/Projects/celebrity-ship-viz/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/hanseulshim/Projects/celebrity-ship-viz/client/src/components/main/charts/Decks.js\";\nimport React, { useState, useContext, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { store } from 'context/store';\nimport { useQuery } from '@apollo/client';\nimport { GET_DECK_CHART } from 'graphql/queries';\nimport { deckLayout } from './config';\nimport { createDecks } from './helper';\nimport Loader from 'components/common/Loader';\nimport Notification from 'components/common/Notification';\nimport Plot from 'react-plotly.js';\nimport decksBlurry from 'assets/decksBlurry.png';\nconst Blurry = styled.img`\n\twidth: 400px;\n`;\n\nconst Decks = () => {\n  const globalState = useContext(store);\n  const state = globalState.state;\n  const selectedShip = state.selectedShip,\n        selectedSailDate = state.selectedSailDate,\n        selectedBookingWeek = state.selectedBookingWeek;\n\n  const _useQuery = useQuery(GET_DECK_CHART, {\n    variables: {\n      shipId: selectedShip.id,\n      sailingDate: selectedSailDate.sailingDate,\n      interval: selectedBookingWeek\n    },\n    skip: !selectedShip.id || !selectedSailDate.sailingDate || selectedBookingWeek === null,\n    fetchPolicy: 'network-only'\n  }),\n        networkStatus = _useQuery.networkStatus,\n        error = _useQuery.error,\n        data = _useQuery.data; // local state for plot data\n\n\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        plotData = _useState2[0],\n        setPlotdata = _useState2[1];\n\n  useEffect(() => {\n    if (data) {\n      const bars = Object.keys(data.deckChart);\n      const barData = bars.filter(v => v !== '__typename' && v !== 'y').map(bar => createDecks(data.deckChart[bar], bar, data.deckChart.y));\n      setPlotdata(barData);\n    }\n  }, [selectedShip, selectedSailDate, selectedBookingWeek, data, networkStatus]);\n\n  if (!selectedShip.id || !selectedSailDate.sailingDate || selectedBookingWeek === null) {\n    return React.createElement(Blurry, {\n      src: decksBlurry,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    });\n  }\n\n  if (networkStatus !== 2 && networkStatus !== 7) return React.createElement(Loader, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  });\n  if (error) return React.createElement(Notification, {\n    type: \"error\",\n    message: error.message,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  });\n  return React.createElement(React.Fragment, null, React.createElement(Plot, {\n    data: plotData,\n    layout: deckLayout,\n    config: {\n      displayModeBar: false\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }));\n};\n\nexport default Decks;","map":{"version":3,"sources":["/Users/hanseulshim/Projects/celebrity-ship-viz/client/src/components/main/charts/Decks.js"],"names":["React","useState","useContext","useEffect","styled","store","useQuery","GET_DECK_CHART","deckLayout","createDecks","Loader","Notification","Plot","decksBlurry","Blurry","img","Decks","globalState","state","selectedShip","selectedSailDate","selectedBookingWeek","variables","shipId","id","sailingDate","interval","skip","fetchPolicy","networkStatus","error","data","plotData","setPlotdata","bars","Object","keys","deckChart","barData","filter","v","map","bar","y","message","displayModeBar"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,UAA1B,EAAsCC,SAAtC,QAAuD,OAAvD;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,SAASC,KAAT,QAAsB,eAAtB;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,SAASC,cAAT,QAA+B,iBAA/B;AACA,SAASC,UAAT,QAA2B,UAA3B;AACA,SAASC,WAAT,QAA4B,UAA5B;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AACA,OAAOC,YAAP,MAAyB,gCAAzB;AACA,OAAOC,IAAP,MAAiB,iBAAjB;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AAEA,MAAMC,MAAM,GAAGV,MAAM,CAACW,GAAI;;CAA1B;;AAIA,MAAMC,KAAK,GAAG,MAAM;AACnB,QAAMC,WAAW,GAAGf,UAAU,CAACG,KAAD,CAA9B;AADmB,QAEXa,KAFW,GAEDD,WAFC,CAEXC,KAFW;AAAA,QAGXC,YAHW,GAG6CD,KAH7C,CAGXC,YAHW;AAAA,QAGGC,gBAHH,GAG6CF,KAH7C,CAGGE,gBAHH;AAAA,QAGqBC,mBAHrB,GAG6CH,KAH7C,CAGqBG,mBAHrB;;AAAA,oBAKoBf,QAAQ,CAACC,cAAD,EAAiB;AAC/De,IAAAA,SAAS,EAAE;AACVC,MAAAA,MAAM,EAAEJ,YAAY,CAACK,EADX;AAEVC,MAAAA,WAAW,EAAEL,gBAAgB,CAACK,WAFpB;AAGVC,MAAAA,QAAQ,EAAEL;AAHA,KADoD;AAM/DM,IAAAA,IAAI,EACH,CAACR,YAAY,CAACK,EAAd,IACA,CAACJ,gBAAgB,CAACK,WADlB,IAEAJ,mBAAmB,KAAK,IATsC;AAU/DO,IAAAA,WAAW,EAAE;AAVkD,GAAjB,CAL5B;AAAA,QAKXC,aALW,aAKXA,aALW;AAAA,QAKIC,KALJ,aAKIA,KALJ;AAAA,QAKWC,IALX,aAKWA,IALX,EAkBnB;;;AAlBmB,oBAmBa9B,QAAQ,CAAC,EAAD,CAnBrB;AAAA;AAAA,QAmBZ+B,QAnBY;AAAA,QAmBFC,WAnBE;;AAqBnB9B,EAAAA,SAAS,CAAC,MAAM;AACf,QAAI4B,IAAJ,EAAU;AACT,YAAMG,IAAI,GAAGC,MAAM,CAACC,IAAP,CAAYL,IAAI,CAACM,SAAjB,CAAb;AACA,YAAMC,OAAO,GAAGJ,IAAI,CAClBK,MADc,CACNC,CAAD,IAAOA,CAAC,KAAK,YAAN,IAAsBA,CAAC,KAAK,GAD5B,EAEdC,GAFc,CAETC,GAAD,IAASjC,WAAW,CAACsB,IAAI,CAACM,SAAL,CAAeK,GAAf,CAAD,EAAsBA,GAAtB,EAA2BX,IAAI,CAACM,SAAL,CAAeM,CAA1C,CAFV,CAAhB;AAGAV,MAAAA,WAAW,CAACK,OAAD,CAAX;AACA;AACD,GARQ,EAQN,CAACnB,YAAD,EAAeC,gBAAf,EAAiCC,mBAAjC,EAAsDU,IAAtD,EAA4DF,aAA5D,CARM,CAAT;;AAUA,MACC,CAACV,YAAY,CAACK,EAAd,IACA,CAACJ,gBAAgB,CAACK,WADlB,IAEAJ,mBAAmB,KAAK,IAHzB,EAIE;AACD,WAAO,oBAAC,MAAD;AAAQ,MAAA,GAAG,EAAER,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACA;;AACD,MAAIgB,aAAa,KAAK,CAAlB,IAAuBA,aAAa,KAAK,CAA7C,EAAgD,OAAO,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AAChD,MAAIC,KAAJ,EAAW,OAAO,oBAAC,YAAD;AAAc,IAAA,IAAI,EAAC,OAAnB;AAA2B,IAAA,OAAO,EAAEA,KAAK,CAACc,OAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AACX,SACC,0CACC,oBAAC,IAAD;AACC,IAAA,IAAI,EAAEZ,QADP;AAEC,IAAA,MAAM,EAAExB,UAFT;AAGC,IAAA,MAAM,EAAE;AAAEqC,MAAAA,cAAc,EAAE;AAAlB,KAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADD;AASA,CAjDD;;AAmDA,eAAe7B,KAAf","sourcesContent":["import React, { useState, useContext, useEffect } from 'react'\nimport styled from 'styled-components'\nimport { store } from 'context/store'\nimport { useQuery } from '@apollo/client'\nimport { GET_DECK_CHART } from 'graphql/queries'\nimport { deckLayout } from './config'\nimport { createDecks } from './helper'\nimport Loader from 'components/common/Loader'\nimport Notification from 'components/common/Notification'\nimport Plot from 'react-plotly.js'\nimport decksBlurry from 'assets/decksBlurry.png'\n\nconst Blurry = styled.img`\n\twidth: 400px;\n`\n\nconst Decks = () => {\n\tconst globalState = useContext(store)\n\tconst { state } = globalState\n\tconst { selectedShip, selectedSailDate, selectedBookingWeek } = state\n\n\tconst { networkStatus, error, data } = useQuery(GET_DECK_CHART, {\n\t\tvariables: {\n\t\t\tshipId: selectedShip.id,\n\t\t\tsailingDate: selectedSailDate.sailingDate,\n\t\t\tinterval: selectedBookingWeek\n\t\t},\n\t\tskip:\n\t\t\t!selectedShip.id ||\n\t\t\t!selectedSailDate.sailingDate ||\n\t\t\tselectedBookingWeek === null,\n\t\tfetchPolicy: 'network-only'\n\t})\n\n\t// local state for plot data\n\tconst [plotData, setPlotdata] = useState([])\n\n\tuseEffect(() => {\n\t\tif (data) {\n\t\t\tconst bars = Object.keys(data.deckChart)\n\t\t\tconst barData = bars\n\t\t\t\t.filter((v) => v !== '__typename' && v !== 'y')\n\t\t\t\t.map((bar) => createDecks(data.deckChart[bar], bar, data.deckChart.y))\n\t\t\tsetPlotdata(barData)\n\t\t}\n\t}, [selectedShip, selectedSailDate, selectedBookingWeek, data, networkStatus])\n\n\tif (\n\t\t!selectedShip.id ||\n\t\t!selectedSailDate.sailingDate ||\n\t\tselectedBookingWeek === null\n\t) {\n\t\treturn <Blurry src={decksBlurry} />\n\t}\n\tif (networkStatus !== 2 && networkStatus !== 7) return <Loader />\n\tif (error) return <Notification type=\"error\" message={error.message} />\n\treturn (\n\t\t<>\n\t\t\t<Plot\n\t\t\t\tdata={plotData}\n\t\t\t\tlayout={deckLayout}\n\t\t\t\tconfig={{ displayModeBar: false }}\n\t\t\t/>\n\t\t</>\n\t)\n}\n\nexport default Decks\n"]},"metadata":{},"sourceType":"module"}